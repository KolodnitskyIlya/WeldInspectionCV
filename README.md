# WeldInspectionCV – Анализ рентгеновских снимков сварных швов

**Описание:**
Проект на **Streamlit** для анализа рентгеновских снимков сварных швов с использованием модели **YOLO**. Приложение позволяет:

* Загружать одиночные или несколько рентгеновских снимков.
* Предобрабатывать изображения (адаптивное усиление контраста и нормализация).
* Обнаруживать дефекты сварных швов и оценивать их тип, серьёзность и статус.
* Пакетно анализировать изображения с выводом сводной таблицы и CSV для скачивания.
* Поддерживает дефекты типа «пора», «включение», «подрез», «несплавление», «непровар корня», «утяжина» и эталоны.

---

## Функционал

1. **Загрузка изображений**: можно загружать одно или несколько изображений одновременно.
2. **Предобработка изображений**:

   * Усиление контраста с адаптивным гамма-корректированием.
   * CLAHE и нормализация яркости.
3. **Анализ дефектов с YOLO**:

   * Определение типа дефекта.
   * Вычисление площади, длины, ширины.
   * Классификация дефектов как "Допустимо", "Требует проверки" или "Недопустимо".
4. **Сводка результатов**:

   * Количество дефектов на изображение.
   * Общий вердикт (✅ Допустимо, ⚠️ Требует проверки, ❌ Недопустимо).
5. **Экспорт данных**:

   * Скачать результаты анализа одного изображения или пакета в формате CSV.

---

## Установка

1. Клонируйте репозиторий:

```bash
git clone https://github.com/ваш_репозиторий/WeldInspectionCV.git
cd WeldInspectionCV
```

2. Создайте виртуальное окружение и установите зависимости:

```bash
python -m venv venv
source venv/bin/activate  # Linux/macOS
venv\Scripts\activate     # Windows

pip install --upgrade pip
pip install -r requirements.txt
```

**requirements.txt** должен содержать примерно:

```
streamlit
ultralytics
opencv-python
pillow
numpy
pandas
```

3. Поместите файл модели **YOLO** (например, `best.pt`) в корень проекта.

---

## Запуск

Для одиночного анализа:

```bash
streamlit run app.py
```

Для пакетного анализа:

```bash
streamlit run app.py
```

После запуска откроется интерфейс Streamlit в браузере.

---

## Использование

1. Выберите один или несколько рентгеновских снимков.
2. Настройте пороги уверенности (Confidence Threshold) и IoU в боковой панели.
3. Нажмите **Запустить анализ** (одиночный) или **Запустить пакетный анализ** (несколько файлов).
4. Просмотрите результаты в таблице и скачайте CSV для дальнейшего использования.

---

## Примечания

* Все эталоны (`эталон1`, `эталон2`) автоматически считаются **Допустимыми**.
* Если дефект не попадает под известные классы, он получает статус **Нет нормы** с вероятностью 0.5.
* Предобработка изображений улучшает качество распознавания модели.

